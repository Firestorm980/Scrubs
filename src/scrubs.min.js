!function($,window,document,undefined){function Plugin(element,options){this.element=element,this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this._init()}var pluginName="Scrubs",defaults={controls:!0,input:!0,startAt:50,sticky:!1,vertical:!1,onInit:function(){},onStart:function(){},onScrub:function(){},onComplete:function(){}};$.extend(Plugin.prototype,{_vars:{prefix:"",transforms:!1,transforms3d:!1},_init:function(){var $this=$(this.element),imagesArray=$this.find("img").toArray(),beforeImage=imagesArray[0],afterImage=imagesArray[1];this._checkTransformSupport(),this._vars.prefix=this._checkWhichTransform(),this._constructor(this.element,beforeImage,afterImage),this._bind(this.element),this.reset(),this._isFunction(this.options.onInit)&&this.options.onInit.call(this)},_bind:function(el){var $this=$(el),options=this.options;options.input&&($this.on("mousedown mouseup touchstart touchend",{options:options},this._transToggle),$this.on("mousedown mouseup touchstart touchend touchcancel",{options:options},this._changeBinding),$this.on("mousedown touchstart",{options:options},this._calcPercent))},_calcPercent:function(event){var $this=$(this),options=event.data.options,inputX="mousedown"===event.type||"mousemove"===event.type?event.pageX:event.originalEvent.touches[0].pageX,inputY="mousedown"===event.type||"mousemove"===event.type?event.pageY:event.originalEvent.touches[0].pageY,offsetX=$this.offset().left,offsetY=$this.offset().top,totalWidth=$this.width(),totalHeight=$this.height(),positionX=inputX-offsetX,positionY=inputY-offsetY,percentX=parseInt(positionX/totalWidth*100),percentY=parseInt(positionY/totalHeight*100);event.preventDefault(),options.vertical?(Plugin.prototype._setPercent($this,percentY),Plugin.prototype._scrubTo($this[0],options,percentY)):(Plugin.prototype._setPercent($this,percentX),Plugin.prototype._scrubTo($this[0],options,percentX))},_changeBinding:function(event){var $this=$(this),eventType=event.type,options=event.data.options;"mousedown"===eventType||"touchstart"===eventType?($this.on("mousemove touchmove",{options:options},Plugin.prototype._calcPercent),$this.one("mouseleave",{options:options},Plugin.prototype._changeBinding)):("mouseup"===eventType||"touchend"===eventType||"touchcancel"===eventType)&&($this.off("mousemove touchmove",Plugin.prototype._calcPercent),Plugin.prototype._scrubTo($this[0],options))},_checkTransformSupport:function(){var elMatrix2d,elMatrix3d,el=document.createElement("div"),matrix2d="matrix(1, 0, 0, 1, 1, 1)",matrix3d="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1)",transforms={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(el,null);for(var t in transforms)el.style[t]!==undefined&&(el.style[t]="translate(1px,1px)",elMatrix2d=window.getComputedStyle(el).getPropertyValue(transforms[t]),el.style[t]="translate3d(1px,1px, 1px)",elMatrix3d=window.getComputedStyle(el).getPropertyValue(transforms[t]));document.body.removeChild(el),elMatrix3d!==undefined&&elMatrix3d.length>0&&"none"!==elMatrix3d&&elMatrix3d===matrix3d?(this._vars.transforms=!0,this._vars.transforms3d=!0):elMatrix2d!==undefined&&elMatrix2d.length>0&&"none"!==elMatrix2d&&elMatrix2d===matrix2d&&(this._vars.transforms=!0)},_checkWhichTransform:function(){var el=document.createElement("fakeelement"),transforms={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var t in transforms)if(el.style[t]!==undefined)return transforms[t]},_constructor:function(el,beforeImage,afterImage){var $this=$(el),$beforeImage=$(beforeImage),$afterImage=$(afterImage),$imagePlaceholder=$beforeImage.clone();$this.addClass("scrubs-scrubber"),this.options.vertical&&$this.addClass("scrubs-vertical"),this._vars.transforms||$this.addClass("scrubs-fallback"),$this.attr("data-transition",!0),this._setPercent($this,50),$this.append('<div class="scrubs-images"></div>'),this.options.controls&&$this.append('<div class="scrubs-controls scrubs-trans"><span id="scrubsControlsBar" class="scrubs-controls-bar"></span><span id="scrubsControlsHandle" class="scrubs-controls-handle"></span></div>'),$imagePlaceholder.addClass("scrubs-image-placeholder"),$beforeImage.addClass("scrubs-image"),$afterImage.addClass("scrubs-overlay-image scrubs-image scrubs-trans"),$this.find(".scrubs-images").append($imagePlaceholder).append($beforeImage).append($afterImage),$beforeImage.wrap('<div class="scrubs-image-container scrubs-image-container-before"></div>'),$afterImage.wrap('<div class="scrubs-overlay scrubs-image-container scrubs-image-container-after scrubs-trans"></div>')},_isFunction:function(possibleFunction){return typeof possibleFunction==typeof Function},_scrubTo:function(el,options,scrollPercent,isStartingNumberBoolean,isStickyBoolean){var $this=$(el),$overlay=$this.find(".scrubs-overlay"),$image=$this.find(".scrubs-overlay-image"),$controls=$this.find(".scrubs-controls"),isInputActive=$this.data("plugin_Scrubs.isInputActive"),isStartingNumber=isStartingNumberBoolean||!1,isSticky=isStickyBoolean||!1,isVertical=options.vertical,percent=isNaN(scrollPercent)?100-$this.data("plugin_Scrubs.percent"):100-scrollPercent,prefix=this._vars.prefix,startingNumber=options.startAt>100||options.startAt<0?50:options.startAt;isInputActive||(isStartingNumber===!0?percent=-(startingNumber-100):options.sticky||isSticky||(percent>50?percent=100:50>=percent&&(percent=0))),0>percent?percent=0:percent>100&&(percent=100),this._setPercent($this,-(percent-100)),this._vars.transforms3d?isVertical?($overlay.css(prefix,"translate3d(0,-"+percent+"%,0)"),$image.css(prefix,"translate3d(0,"+percent+"%,0)"),$controls.css(prefix,"translate3d(0,-"+percent+"%,0)")):($overlay.css(prefix,"translate3d(-"+percent+"%,0,0)"),$image.css(prefix,"translate3d("+percent+"%,0,0)"),$controls.css(prefix,"translate3d(-"+percent+"%,0,0)")):this._vars.transforms?isVertical?($overlay.css(prefix,"translateY(-"+percent+"%)"),$image.css(prefix,"translateY("+percent+"%)"),$controls.css(prefix,"translateY(-"+percent+"%)")):($overlay.css(prefix,"translateX(-"+percent+"%)"),$image.css(prefix,"translateX("+percent+"%)"),$controls.css(prefix,"translateX(-"+percent+"%)")):isVertical?($overlay.css({bottom:percent+"%"}),$image.css({top:percent+"%"}),$controls.css({bottom:percent+"%"})):($overlay.css({right:percent+"%"}),$image.css({left:percent+"%"}),$controls.css({right:percent+"%"})),this._isFunction(options.onScrub)&&!isStartingNumber&&isInputActive?options.onScrub.call(this,-(percent-100)):!this._isFunction(options.onComplete)||isStartingNumber||isInputActive||options.onComplete.call(this,-(percent-100))},_setPercent:function(el,percent){this.percent=percent,el.data("plugin_Scrubs.percent",percent)},_transToggle:function(event){var $this=$(this),eventType=event.type,options=event.data.options;"mousedown"===eventType||"touchstart"===eventType?($this.attr("data-transition",!1),$this.data("plugin_Scrubs.isInputActive",!0),Plugin.prototype._isFunction(options.onStart)&&options.onStart.call(this,this.percent)):("mouseup"===eventType||"touchend"===eventType)&&($this.attr("data-transition",!0),$this.data("plugin_Scrubs.isInputActive",!1))},reset:function(){this._scrubTo(this.element,this.options,this.options.startAt,!0)},end:function(){this._scrubTo(this.element,this.options,100,!1)},start:function(){this._scrubTo(this.element,this.options,0,!1)},scrub:function(number,sticky){isNaN(number)||this._scrubTo(this.element,this.options,number,!1,sticky)}}),$.fn[pluginName]=function(options){var args=Array.prototype.slice.call(arguments,1);return this.each(function(){var instance=$.data(this,"plugin_"+pluginName);instance?"string"==typeof options&&"_"!==options.charAt(0)&&instance[options].apply(instance,args):$.data(this,"plugin_"+pluginName,new Plugin(this,options))}),this}}(jQuery,window,document);
