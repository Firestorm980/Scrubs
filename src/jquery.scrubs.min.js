!function(t,e,n,a){"use strict";function s(e,n){this.element=e,this._name=o,this._defaults=t.fn[o].defaults,this.options=t.extend({},this._defaults,n),this._init()}var o="Scrubs",i="",r=!1,c=!1,l=!1;t.extend(s.prototype,{_init:function(){var t=this;t._checkTransformSupport(),t._setTransformProperty(),t._setRAF(),t._buildCache(),t._scrubsConstruct(),t._bindEvents(),t.reset(),t._isFunction(t.options.onInit)&&t.options.onInit.call(t)},_destroy:function(){this._unbindEvents(),this.$element.removeData()},_buildCache:function(){this.$element=t(this.element);var e={velocity:0,amplitude:0,current:{x:0,y:0,time:0},last:{x:0,y:0,time:0},delta:{x:0,y:0,time:0},timestamp:0,percent:0,frame:null};this.momentum=e},_bindEvents:function(){var t=this,e=t.options,n=t.$element;e.input&&(n.on("mousedown."+t._name,function(e){t._transitionToggle.call(t,e),t._changeBinding.call(t,e),t._calculatePercent.call(t,e)}),n.on("mouseup."+t._name,function(e){t._transitionToggle.call(t,e),t._changeBinding.call(t,e)}),n.on("touchstart."+t._name,function(e){t._transitionToggle.call(t,e),t._changeBinding.call(t,e),t._calculatePercent.call(t,e)}),n.on("touchend."+t._name,function(e){t._transitionToggle.call(t,e),t._changeBinding.call(t,e)}),n.on("touchcancel."+t._name,function(e){t._changeBinding.call(t,e)}))},_unbindEvents:function(){this.$element.off("."+this._name)},_calculatePercent:function(e){var n=this,a=n.options,s=n.momentum,o=t(n.element),i=e.type,r="mousedown"===i||"mousemove"===i?e.pageX:e.originalEvent.touches[0].pageX,c="mousedown"===i||"mousemove"===i?e.pageY:e.originalEvent.touches[0].pageY,l=o.offset().left,m=o.offset().top,u=o.width(),f=o.height(),p=r-l,d=c-m,_=parseInt(p/u*100),h=parseInt(d/f*100),v={x:_,y:h,time:Date.now()},g=s.last,b={x:v.x-g.x,y:v.y-g.y,time:v.time-g.time};s.delta=b,s.last=v,e.preventDefault(),a.vertical?(s.velocity=.8*(1e3*b.y/(1+b.time))+.2*s.velocity,n._setPercent.call(n,h),n._scrubTo.call(n,h)):(s.velocity=.8*(1e3*b.x/(1+b.time))+.2*s.velocity,n._setPercent.call(n,_),n._scrubTo.call(n,_))},_changeBinding:function(t){var e=this,n=e.options,a=e.$element,s=t.type;switch(s){case"mousedown":case"touchstart":a.on("mousemove."+e._name,function(t){l||(l=!0,requestAnimFrame(function(){e._calculatePercent.call(e,t)}))}),a.one("mouseleave."+e._name,function(t){e._changeBinding.call(e,t)}),a.on("touchmove."+e._name,function(t){l||(l=!0,requestAnimFrame(function(){e._calculatePercent.call(e,t)}))});break;case"mouseup":case"touchend":case"touchcancel":a.off("mousemove."+e._name),a.off("touchmove."+e._name),n.momentum?e._momentumUp.call(e):e._scrubTo.call(e)}},_checkTransformSupport:function(){var t,s,o=n.createElement("div"),i="matrix(1, 0, 0, 1, 1, 1)",l="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1)",m={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};n.body.insertBefore(o,null);for(var u in m)o.style[u]!==a&&(o.style[u]="translate(1px,1px)",t=e.getComputedStyle(o).getPropertyValue(m[u]),o.style[u]="translate3d(1px,1px, 1px)",s=e.getComputedStyle(o).getPropertyValue(m[u]));n.body.removeChild(o),s!==a&&s.length>0&&"none"!==s&&s===l&&(c=!0),t!==a&&t.length>0&&"none"!==t&&t===i&&(r=!0)},_setTransformProperty:function(){var t=n.createElement("fakeelement"),e={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var s in e)t.style[s]!==a&&(i=e[s])},_isFunction:function(t){return typeof t==typeof Function},_momentumUp:function(){var t=this,e=t.momentum,n=t.$element.data("plugin_"+o+".percent");(e.velocity>10||e.velocity<-10)&&(e.amplitude=t.options.friction*e.velocity,e.timestamp=Date.now(),e.percent=Math.round(n+e.amplitude),requestAnimFrame(function(){t._momentumScrub.call(t)}))},_momentumScrub:function(){var t=this,e=t.momentum,n=Date.now()-e.timestamp,a=-e.amplitude*Math.exp(-n/325),s=t.$element.data("plugin_"+o+".isInputActive");s||(e.amplitude&&(a>1||-1>a)?(t._scrubTo.call(t,e.percent+a,!1,!0),l||(l=!0,e.frame=requestAnimFrame(function(){t._momentumScrub.call(t)}))):l||(l=!0,e.frame=requestAnimFrame(function(){t._scrubTo.call(t,e.percent,!1,!0),t.$element.attr("data-transition",!0)})))},_momentumReset:function(e){var n=this,a=(n.options,n.momentum),s=t(n.element),o=e.type,i="mousedown"===o||"mousemove"===o?e.pageX:e.originalEvent.touches[0].pageX,r="mousedown"===o||"mousemove"===o?e.pageY:e.originalEvent.touches[0].pageY,c=s.offset().left,l=s.offset().top,m=s.width(),u=s.height(),f=i-c,p=r-l,d=parseInt(f/m*100),_=parseInt(p/u*100),h={x:d,y:_,time:Date.now()},v=h,g={x:0,y:0,time:0};console.log("reset"),a.delta=g,a.current=h,a.last=v,cancelRequestAnimFrame(a.frame)},_scrubsConstruct:function(){var e=this,n=e.options,a=e.$element,s=a.find("img").toArray(),o=s[0],i=s[1],c=t(o),l=t(i),m=c.clone(),u=c.width();a.addClass("scrubs-scrubber").css({maxWidth:u}),n.vertical&&a.addClass("scrubs-vertical"),r||a.addClass("scrubs-fallback"),a.attr("data-transition",!0),a.append('<div class="scrubs-images"></div>'),n.controls&&a.append('<div class="scrubs-controls scrubs-trans"><span id="scrubsControlsBar" class="scrubs-controls-bar"></span><span id="scrubsControlsHandle" class="scrubs-controls-handle"></span></div>'),m.addClass("scrubs-image-placeholder"),c.addClass("scrubs-image"),l.addClass("scrubs-overlay-image scrubs-image scrubs-trans"),a.find(".scrubs-images").append(m).append(c).append(l),c.wrap('<div class="scrubs-image-container scrubs-image-container-before"></div>'),l.wrap('<div class="scrubs-overlay scrubs-image-container scrubs-image-container-after scrubs-trans"></div>')},_scrubTo:function(t,e,n){var a=this,s=a.options,m=a.$element,u=m.find(".scrubs-overlay"),f=m.find(".scrubs-overlay-image"),p=m.find(".scrubs-controls"),d=m.data("plugin_"+o+".isInputActive"),_=e||!1,h=n||!1,v=s.vertical,g=isNaN(t)?100-m.data("plugin_"+o+".percent"):100-t,b=s.startAt>100||s.startAt<0?50:s.startAt;d||(_===!0?g=-(b-100):s.sticky||h||(g>50?g=100:50>=g&&(g=0))),0>g?g=0:g>100&&(g=100),a._setPercent.call(a,-(g-100)),c?v?(u.css(i,"translate3d(0,-"+g+"%,0)"),f.css(i,"translate3d(0,"+g+"%,0)"),p.css(i,"translate3d(0,-"+g+"%,0)")):(u.css(i,"translate3d(-"+g+"%,0,0)"),f.css(i,"translate3d("+g+"%,0,0)"),p.css(i,"translate3d(-"+g+"%,0,0)")):r?v?(u.css(i,"translateY(-"+g+"%)"),f.css(i,"translateY("+g+"%)"),p.css(i,"translateY(-"+g+"%)")):(u.css(i,"translateX(-"+g+"%)"),f.css(i,"translateX("+g+"%)"),p.css(i,"translateX(-"+g+"%)")):v?(u.css({bottom:g+"%"}),f.css({top:g+"%"}),p.css({bottom:g+"%"})):(u.css({right:g+"%"}),f.css({left:g+"%"}),p.css({right:g+"%"})),a._isFunction(s.onScrub)&&!_&&d?s.onScrub.call(a,-(g-100)):!a._isFunction(s.onComplete)||_||d||s.onComplete.call(a,-(g-100)),l=!1},_setPercent:function(t){this.$element.data("plugin_"+o+".percent",t)},_setRAF:function(){var t=e;t.requestAnimFrame=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)}}(),t.cancelRequestAnimFrame=function(){return t.cancelAnimationFrame||t.webkitCancelRequestAnimationFrame||t.mozCancelRequestAnimationFrame||t.oCancelRequestAnimationFrame||t.msCancelRequestAnimationFrame||clearTimeout}()},_transitionToggle:function(e){var n=this,a=n.options,s=t(n.element),i=s.data("plugin_"+o+".percent"),r=e.type;"mousedown"===r||"touchstart"===r?(s.attr("data-transition",!1),s.data("plugin_"+o+".isInputActive",!0),n._isFunction(a.onStart)&&a.onStart.call(n,i),a.momentum&&n._momentumReset.call(n,e)):("mouseup"===r||"touchend"===r)&&(a.momentum||s.attr("data-transition",!0),s.data("plugin_"+o+".isInputActive",!1))},reset:function(){var t=this;t._scrubTo.call(t,t.options.startAt,!0)},end:function(){var t=this;t._scrubTo.call(t,100,!1)},start:function(){var t=this;t._scrubTo.call(t,0,!1)},scrub:function(t,e){var n=this;isNaN(t)||n._scrubTo.call(n,t,!1,e)}}),t.fn[o]=function(e){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var a=t.data(this,"plugin_"+o);a?"string"==typeof e&&"_"!==e.charAt(0)&&a[e].apply(a,n):t.data(this,"plugin_"+o,new s(this,e))}),this},t.fn[o].defaults={controls:!0,input:!0,startAt:50,sticky:!1,vertical:!1,momentum:!1,friction:.4,onInit:function(){},onStart:function(){},onScrub:function(){},onComplete:function(){}}}(jQuery,window,document);
